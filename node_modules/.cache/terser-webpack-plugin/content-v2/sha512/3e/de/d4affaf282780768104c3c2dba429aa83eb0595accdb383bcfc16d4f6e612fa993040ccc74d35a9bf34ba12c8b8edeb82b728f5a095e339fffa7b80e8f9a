{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{478:function(s,a,t){\"use strict\";t.r(a);var n=t(18),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":s.$parent.slotKey}},[t(\"h1\",{attrs:{id:\"虚拟机性能监控基础工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#虚拟机性能监控基础工具\"}},[s._v(\"#\")]),s._v(\" 虚拟机性能监控基础工具\")]),s._v(\" \"),t(\"p\",[t(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/AJiSun/CDN/jvm-img/jvm-8.png\",alt:\"图片\"}})]),s._v(\" \"),t(\"p\",[s._v(\"前面我们了解了虚拟机的相关的技术，大概对虚拟机有一个比较系统的认识。前面的大部分是理论知识，也有些会参杂些实操，但是实际遇到问题还是远远不够的，下面我们通过JDK官方的小工具来实践一下。准确的使用工具提升我们定位 ，解决问题的效率。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"_1-jps-虚拟机进程状况工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_1-jps-虚拟机进程状况工具\"}},[s._v(\"#\")]),s._v(\" 1. jps: 虚拟机进程状况工具\")]),s._v(\" \"),t(\"p\",[t(\"strong\",[s._v(\"jps(JVM Process Status Tool)\")]),s._v(\" 是虚拟机进程状态的工具，可以列出虚拟机正在运行的虚拟机进程，并像是虚拟机执行主类(Main Class, main()函数所在的类) 名称以及这些进程的本地虚拟机唯一的ID(LVMID，Local Virtual Machine Identifier)。此命令绝对是使用频率最高的JDK命令行工具了(因为其他的JDK工具大多需要输入它查询到的LVMID来确定要监控的是哪一个虚拟机进程)。\")]),s._v(\" \"),t(\"p\",[s._v(\"对于本地虚拟机进程来说，LVMID与操作系统的进程ID（PID，Process Identifier）是一致的，使用Windows的任务管理器或者UNIX的ps命令也可以查询到虚拟机进程的LVMID，但如果同时启动了多个虚拟机进程，无法根据进程名称定位时，那就必须依赖jps命令显示主类的功能才能区分了。\")]),s._v(\" \"),t(\"h5\",{attrs:{id:\"jps命令格式\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jps命令格式\"}},[s._v(\"#\")]),s._v(\" jps命令格式\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"jps [ options ] [ hostid ]\")])]),s._v(\" \"),t(\"p\",[s._v(\"如下直接运行jps不加任何参数\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jps\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"537\")]),s._v(\" Check\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51565\")]),s._v(\" Jps\\n\")])])]),t(\"p\",[s._v(\"这个输出可以看出当前系统共存在4个应用程序，其中第二个Jps的是这个命令本身(这个命令本质也是一个Java程序)。\")]),s._v(\" \"),t(\"p\",[s._v(\"Jps 还可以加参数来控制输出(-q, -m, -l,- v)。\")]),s._v(\" \"),t(\"h4\",{attrs:{id:\"jps-q\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jps-q\"}},[s._v(\"#\")]),s._v(\" jps -q\")]),s._v(\" \"),t(\"p\",[s._v(\"只输出进程ID(LVMID)，省略主类的名称\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jps -q\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51573\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"537\")]),s._v(\"\\n\")])])]),t(\"h4\",{attrs:{id:\"jps-m\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jps-m\"}},[s._v(\"#\")]),s._v(\" jps -m\")]),s._v(\" \"),t(\"p\",[s._v(\"输出虚拟机进程启动时传递给主类main()函数的参数\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jps -m\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51585\")]),s._v(\" Jps -m\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"537\")]),s._v(\" Check Point/Mobile Access/CShell.jar\\n\")])])]),t(\"h4\",{attrs:{id:\"jps-l\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jps-l\"}},[s._v(\"#\")]),s._v(\" jps -l\")]),s._v(\" \"),t(\"p\",[s._v(\"输出主类的全名，如果进程执行的是jar包，输出jar路径\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jps -l\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51639\")]),s._v(\" sun.tools.jps.Jps\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"537\")]),s._v(\" /Users/ajisun/Library/Check\\n\")])])]),t(\"h4\",{attrs:{id:\"jps-v\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#jps-v\"}},[s._v(\"#\")]),s._v(\" jps -v\")]),s._v(\" \"),t(\"p\",[s._v(\"输出虚拟机进程启动时JVM的参数\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jps -v\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"51749\")]),s._v(\" sun.tools.jps.Jps -l -m -v -Denv.class.path\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\".:/Library/Java/JavaVirtualMachines/jdk1.8.0_161.jdk/Contents/Home/lib/dt.jar:/Library/Java/JavaVirtualMachines/jdk1.8.0_161.jdk/Contents/Home/lib/tools.jar -Dapplication.home\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/Library/Java/JavaVirtualMachines/jdk1.8.0_161.jdk/Contents/Home -Xms8m\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"537\")]),s._v(\" /Users/ajisun/Library/Check Point/Mobile Access/CShell.jar\\n\")])])]),t(\"h3\",{attrs:{id:\"_2-jinfo-java配置信息工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_2-jinfo-java配置信息工具\"}},[s._v(\"#\")]),s._v(\" 2.jinfo: Java配置信息工具\")]),s._v(\" \"),t(\"p\",[t(\"strong\",[s._v(\"jinfo(Configuration Info for Java)\")]),s._v(\" 的作用是实时查看和调整虚拟机各项参数。\")]),s._v(\" \"),t(\"p\",[s._v(\"基本语法\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"jinfo [option] {pid}\")])]),s._v(\" \"),t(\"p\",[s._v(\"其中option的可以为\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"-flag {name}打印指定Java虚拟机的参数值。\")]),s._v(\" \"),t(\"li\",[s._v(\"-flag [+|-]{name} 设置指定Java虚拟机参数的布尔值。(+代表true，-代表false)\")]),s._v(\" \"),t(\"li\",[s._v(\"-flag {name}={value} 设置指定Java虚拟机的参数值\")])]),s._v(\" \"),t(\"p\",[s._v(\"例如打印新生代晋升老年代的年龄\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jinfo -flag MaxTenuringThreshold \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"11825\")]),s._v(\"\\n-XX:MaxTenuringThreshold\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"15\")]),s._v(\"\\n\")])])]),t(\"p\",[s._v(\"例如显示是否打印GC信息\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jinfo -flag PrintGC \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"12046\")]),s._v(\"\\n-XX:-PrintGC\\n\")])])]),t(\"p\",[s._v(\"除了上面的查找参数外，还支持设置参数(不是所有的参数都支持这种设置)\")]),s._v(\" \"),t(\"p\",[s._v(\"手动打开gc日志的参数可以动态开启或者关闭\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jinfo -flag PrintGC \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"12190\")]),s._v(\"  // 查看参数 未设置\\n-XX:-PrintGC\\najisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jinfo -flag +PrintGC \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"12190\")]),s._v(\"  //设置参数\\najisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jinfo -flag PrintGC \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"12190\")]),s._v(\"   // 查看参数已设置\\n-XX:+PrintGC\\n\")])])]),t(\"h3\",{attrs:{id:\"_3-jmap-java内存映射工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3-jmap-java内存映射工具\"}},[s._v(\"#\")]),s._v(\" 3. jmap: Java内存映射工具\")]),s._v(\" \"),t(\"p\",[t(\"strong\",[s._v(\"jmap(Memory Map for Java)\")]),s._v(\" 命令用于生成堆转储快照（一般称为heapdump或dump文件）。jmap的作用并不仅仅是为了获取堆转储快照，它还可以查询finalize执行队列、Java堆和方法区的 详细信息，如空间使用率、当前用的是哪种收集器等。\")]),s._v(\" \"),t(\"p\",[s._v(\"基本语法\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"jmap [option] {pid}\")])]),s._v(\" \"),t(\"p\",[s._v(\"其中option可以为\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"-dump：生成java堆转储快照，格式为：-dump:[live,]format=b,file={filename},其中live子参数说明是否只dump出存活对象。\")]),s._v(\" \"),t(\"li\",[s._v(\"-finalizerinfo：显示在F-Queue中等待Finalizer线程执行finalize方法的对象，只在linux/solaris平台下有效。\")]),s._v(\" \"),t(\"li\",[s._v(\"-heap：显示堆详细信息，如使用哪种回收期、参数配置、分带状况等，只在linux/solaris平台下有效。\")]),s._v(\" \"),t(\"li\",[s._v(\"-histo：显示堆中对象统计信息，包括类、实例数量和合计容量。\")]),s._v(\" \"),t(\"li\",[s._v(\"-clstats：以ClassLoader为统计口径显示永久代内存状况，只在linux/solaris平台下有效。\")]),s._v(\" \"),t(\"li\",[s._v(\"-F：当虚拟机进程对-dump选项没有响应时，可以使用这个选项强制生成dump快照，只在linux/solaris平台下有效。\")])]),s._v(\" \"),t(\"p\",[s._v(\"dump导出应用程序的快照\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jmap -dump:format\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"b,file\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\"/Users/ajisun/Desktop/jvmTest/s.txt \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"13157\")]),s._v(\"\\nDumping heap to /Users/ajisun/Desktop/jvmTest/s.txt \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"..\")]),s._v(\".\\nHeap dump \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"file\")]),s._v(\" created\\n\")])])]),t(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/AJiSun/CDN/jvm-img/jvm-8-jmap-1.png\"}}),s._v(\" \"),t(\"p\",[s._v(\"可以用jhat或者其他工具分析此快照。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"_4-jhat-分析java应用程序的堆快照内容\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_4-jhat-分析java应用程序的堆快照内容\"}},[s._v(\"#\")]),s._v(\" 4. jhat: 分析Java应用程序的堆快照内容\")]),s._v(\" \"),t(\"p\",[t(\"strong\",[s._v(\"jhat(JVM Heap Analysis Tool)\")]),s._v(\" 命令是jdk提供的与jmap搭配使用，来分析jmap生成的堆转储快照。\")]),s._v(\" \"),t(\"p\",[s._v(\"如上文dump的文件\")]),s._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /> jhat /Users/ajisun/Desktop/jvmTest/s.txt\\nReading from /Users/ajisun/Desktop/jvmTest/s.txt...\\nDump file created Tue Jan 04 15:05:15 CST 2022\\nSnapshot read, resolving...\\nResolving 19265 objects...\\nChasing references, expect 3 dots...\\nEliminating duplicate references...\\nSnapshot resolved.\\nStarted HTTP server on port 7000\\nServer is ready.\\n\")])])]),t(\"p\",[s._v(\"上面输出是分析后的内容，还可以在浏览器中查看，访问http://localhost:7000\")]),s._v(\" \"),t(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/AJiSun/CDN/jvm-img/jvm-8-jhat-1.png\"}}),s._v(\" \"),t(\"p\",[s._v(\"如图显示的信息是一个链接，分析内存泄露问题主要会用到“\"),t(\"strong\",[s._v(\"Show heap histogram\")]),s._v(\"” 和“\"),t(\"strong\",[s._v(\"OQL\")]),s._v(\"”，前者可以找到内存中总容量最大的对象，后者是标准的对象查询语言，使用类似于SQL的语法对内存对象进行查询统计(点击下图中的OQL Help 可以查看其语法)\")]),s._v(\" \"),t(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/AJiSun/CDN/jvm-img/jvm-8-jhat-2.png\"}}),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"号外：一般不会用直接使用jhat来分析快照，一是分析快照需要占用较多服务器资源，二是这个分析的比较简单 还有更好的分析工具可用，如VisualVM。\")])]),s._v(\" \"),t(\"h3\",{attrs:{id:\"_5-jstack-java堆栈跟踪工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_5-jstack-java堆栈跟踪工具\"}},[s._v(\"#\")]),s._v(\" 5. jstack: Java堆栈跟踪工具\")]),s._v(\" \"),t(\"p\",[t(\"strong\",[s._v(\"jstack(Stack Trace for Java)\")]),s._v(\" 命令用于生成虚拟机当前时刻的线程快照（一般称为threaddump或者 javacore文件）。线程快照就是当前虚拟机内每一条线程正在执行的方法堆栈的集合，生成线程快照的目的通常是定位线程出现长时间停顿的原因，如线程间死锁、死循环、请求外部资源导致的长时间挂起等，都是导致线程长时间停顿的常见原因。线程出现停顿时通过jstack来查看各个线程的调用堆栈，就可以获知没有响应的线程到底在后台做些什么事情，或者等待着什么资源。\")]),s._v(\" \"),t(\"p\",[s._v(\"基本语法\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"jstack [ option ]  {pid}\")])]),s._v(\" \"),t(\"p\",[s._v(\"其中option可以为\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[s._v(\"-F: 当正常输出的请求不被响应时，强制输出线程堆栈。\")]),s._v(\" \"),t(\"li\",[s._v(\"-l: 除堆栈外，显示关于锁的信息。\")])]),s._v(\" \"),t(\"p\",[s._v(\"例如\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[t(\"strong\",[s._v(\"ajisun@ajisun-2 /> jstack -l 12190\")])]),s._v(\" \"),t(\"p\",[s._v(\"2022-01-04 19:48:41\")]),s._v(\" \"),t(\"p\",[s._v(\"Full thread dump Java HotSpot(TM) 64-Bit Server VM (25.161-b12 mixed mode):\")]),s._v(\" \"),t(\"p\",[s._v('\"Attach Listener\" #11 daemon prio=9 os_prio=31 tid=0x00007f8f358db800 nid=0x3407 waiting on condition [0x0000000000000000]')]),s._v(\" \"),t(\"p\",[s._v(\"java.lang.Thread.State: RUNNABLE\")]),s._v(\" \"),t(\"p\",[s._v('\"Service Thread\" #10 daemon prio=9 os_prio=31 tid=0x00007f8f360a8800 nid=0x4003 runnable [0x0000000000000000]')]),s._v(\" \"),t(\"p\",[s._v(\"java.lang.Thread.State: RUNNABLE\")]),s._v(\" \"),t(\"p\",[s._v(\".......\")])]),s._v(\" \"),t(\"p\",[s._v(\"演示下while死循环信息查看\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-java extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"public\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"class\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Test\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"public\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"static\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"void\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"main\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"String\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\" args\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"while\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token boolean\"}},[s._v(\"true\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])])]),t(\"blockquote\",[t(\"p\",[s._v(\"ajisun@ajisun-2 /> jps -l\")]),s._v(\" \"),t(\"p\",[s._v(\"24513  com.ajisun.coding.ajisunmybatis.Test\")]),s._v(\" \"),t(\"p\",[s._v(\"ajisun@ajisun-2 /> jstack -l 24513\")])]),s._v(\" \"),t(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/AJiSun/CDN/jvm-img/jvm-8-jstack-1.png\"}}),s._v(\" \"),t(\"p\",[s._v(\"上图中可以看到线程处于RUNNABLE状态， 在\"),t(\"code\",[s._v(\"com.ajisun.coding.ajisunmybatis.Test.main\")]),s._v(\"方法的15行出现死循环 。出现死循环，等待，死锁等线程都可以看出具体出现的位置。\")]),s._v(\" \"),t(\"p\",[s._v(\"死锁的案例\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-java extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[t(\"code\",[t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"--\")]),s._v(\" 代码如下\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"public\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"class\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Test\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"private\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"static\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Object\")]),s._v(\" objectA \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"new\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Object\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"private\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"static\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Object\")]),s._v(\" objectB \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"=\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"new\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Object\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"public\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"static\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"void\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"main\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"String\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"[\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"]\")]),s._v(\" args\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"new\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Thread\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"->\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"synchronized\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"objectA\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"System\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"out\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"println\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"获取锁objectA\"')]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"try\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                    \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Thread\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sleep\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1000\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"catch\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"InterruptedException\")]),s._v(\" e\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                    e\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"printStackTrace\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"synchronized\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"objectB\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                    \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"System\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"out\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"println\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"获取锁objectB\"')]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"start\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"new\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Thread\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\"->\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"synchronized\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"objectB\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"System\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"out\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"println\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"获取锁objectB\"')]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"try\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                    \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"Thread\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"sleep\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"1000\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"catch\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"InterruptedException\")]),s._v(\" e\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                    e\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"printStackTrace\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[s._v(\"synchronized\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),s._v(\"objectA\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"{\")]),s._v(\"\\n                    \"),t(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[s._v(\"System\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),s._v(\"out\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"println\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token string\"}},[s._v('\"获取锁objectA\"')]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n                \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n            \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n        \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\".\")]),t(\"span\",{pre:!0,attrs:{class:\"token function\"}},[s._v(\"start\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"(\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\")\")]),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\";\")]),s._v(\"\\n    \"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[s._v(\"}\")]),s._v(\"\\n\")])])]),t(\"p\",[s._v(\"开始使用jstack命令，先通过jps找到这个类的pid\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jps -l\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"25537\")]),s._v(\" com.ajisun.coding.ajisunmybatis.Test\\najisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jstack -l \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"25537\")]),s._v(\"\\n\")])])]),t(\"img\",{attrs:{src:\"https://cdn.jsdelivr.net/gh/AJiSun/CDN/jvm-img/jvm-8-jstack-2.png\"}}),s._v(\" \"),t(\"p\",[s._v(\"如上图，根据输出的信息就能确定死锁的位置。以及出现死锁的两个线程互相持有对象以及等待的对象。\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"号外：jstack不仅可以得到线程的堆栈信息，还能看出是否死锁以及死锁的具体信息。\")])]),s._v(\" \"),t(\"h3\",{attrs:{id:\"_6-jcmd-多功能命令行\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_6-jcmd-多功能命令行\"}},[s._v(\"#\")]),s._v(\" 6. jcmd：多功能命令行\")]),s._v(\" \"),t(\"p\",[t(\"strong\",[s._v(\"jcmd(Java Command)\")]),s._v(\" 虚拟机诊断命令工具，一个多功能的命令，可以导出堆，查看java进程，导出线程信息，执行GC等，从jdk1.7开始提供。\")]),s._v(\" \"),t(\"p\",[s._v(\"查看当前系统中的虚拟机\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jcmd -l\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"36372\")]),s._v(\" com.ajisun.coding.ajisunmybatis.Allocation\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"36425\")]),s._v(\" sun.tools.jcmd.JCmd -l\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"11423\")]),s._v(\" \\n\")])])]),t(\"p\",[s._v(\"查看虚拟机36372支持的命令\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jcmd \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"36372\")]),s._v(\" \"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"help\")]),s._v(\"\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"36372\")]),s._v(\":\\nThe following commands are available:\\nJFR.stop\\nJFR.start\\nJFR.dump\\nJFR.check\\nVM.native_memory\\nVM.check_commercial_features\\nVM.unlock_commercial_features\\nManagementAgent.stop\\nManagementAgent.start_local\\nManagementAgent.start\\nGC.rotate_log\\nThread.print\\nGC.class_stats\\nGC.class_histogram\\nGC.heap_dump\\nGC.run_finalization\\nGC.run\\nVM.uptime\\nVM.flags\\nVM.system_properties\\nVM.command_line\\nVM.version\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[s._v(\"help\")]),s._v(\"\\n\")])])]),t(\"p\",[s._v(\"上面输出就是此虚拟机支持的命令\")]),s._v(\" \"),t(\"ul\",[t(\"li\",[t(\"p\",[s._v(\"查看虚拟机启动的时间\")]),s._v(\" \"),t(\"div\",{staticClass:\"language-shell extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-shell\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /\"),t(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[s._v(\">\")]),s._v(\" jcmd \"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"36372\")]),s._v(\" VM.uptime\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"36372\")]),s._v(\":\\n\"),t(\"span\",{pre:!0,attrs:{class:\"token number\"}},[s._v(\"292.741\")]),s._v(\" s\\n\")])])])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"输出线程栈信息（和jstack命令输出相同）\")]),s._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[t(\"code\",[s._v('ajisun@ajisun-2 /> jcmd 36372 Thread.print\\n......\\n\"main\" #1 prio=5 os_prio=31 tid=0x00007f8729808800 nid=0xe03 runnable [0x0000700002b67000]\\n   java.lang.Thread.State: RUNNABLE\\n\\tat com.ajisun.coding.ajisunmybatis.Allocation.main(Allocation.java:39)\\n\\n\"VM Thread\" os_prio=31 tid=0x00007f872a816800 nid=0x5003 runnable \\n......\\n')])])])]),s._v(\" \"),t(\"li\",[t(\"p\",[s._v(\"导出堆信息（和jmap命令功能相同）\")]),s._v(\" \"),t(\"div\",{staticClass:\"language- extra-class\"},[t(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[t(\"code\",[s._v(\"ajisun@ajisun-2 /> jcmd 36372 GC.heap_dump /Users/ajisun/Desktop/jvmTest/jcmd.txt\\n36372:\\nHeap dump file created\\n\")])])])])]),s._v(\" \"),t(\"p\",[s._v(\"由\"),t(\"code\",[s._v(\"jcmd 36372 help\")]),s._v(\" 命令可以看出，jcmd有很多功能，包括覆盖常用的jmap的功能，而且官方也是推荐使用jcmd替换jmap。\")]),s._v(\" \"),t(\"h3\",{attrs:{id:\"_7-jstat-虚拟机统计信息工具\"}},[t(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_7-jstat-虚拟机统计信息工具\"}},[s._v(\"#\")]),s._v(\" 7. jstat：虚拟机统计信息工具\")]),s._v(\" \"),t(\"p\",[s._v(\"用于监视虚拟机各种运行状态信息的命令工具，是比较强大的，可以用来查看堆信息的详细情况。\")]),s._v(\" \"),t(\"p\",[s._v(\"由于这个命令篇幅较多，在下一篇文章中详细介绍\")]),s._v(\" \"),t(\"blockquote\",[t(\"p\",[s._v(\"说明：以上这些命令中部分会出现错误提示\")]),s._v(\" \"),t(\"p\",[s._v(\"Error attaching to process: sun.jvm.hotspot.debugger.DebuggerException: Can't attach symbolicator to the process\")]),s._v(\" \"),t(\"p\",[s._v(\"如果使用的mac电脑，没啥办法，但是在Linux上开启ptrace_scope就没问题的，具体的可以网上搜索下。\")])])])}),[],!1,null,null,null);a.default=e.exports}}]);","extractedComments":[]}